{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[135],{523:function(t,a,s){\"use strict\";s.r(a);var e=s(44),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":t.$parent.slotKey}},[s(\"p\",[t._v(\"[TOC]\")]),t._v(\" \"),s(\"h1\",{attrs:{id:\"第二节-cookie的工作机制\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#第二节-cookie的工作机制\"}},[t._v(\"#\")]),t._v(\" 第二节 Cookie的工作机制\")]),t._v(\" \"),s(\"h2\",{attrs:{id:\"_1、http协议和会话控制\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_1、http协议和会话控制\"}},[t._v(\"#\")]),t._v(\" 1、HTTP协议和会话控制\")]),t._v(\" \"),s(\"p\",[t._v(\"HTTP协议本身是无状态的。单靠HTTP协议本身无法判断一个请求来自于哪一个浏览器，所以也就没法识别用户的身份状态。\")]),t._v(\" \"),s(\"p\",[s(\"img\",{attrs:{src:\"images/img004.png\",alt:\"images\"}})]),t._v(\" \"),s(\"h2\",{attrs:{id:\"_2、cookie介绍\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_2、cookie介绍\"}},[t._v(\"#\")]),t._v(\" 2、Cookie介绍\")]),t._v(\" \"),s(\"h3\",{attrs:{id:\"_1本质\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_1本质\"}},[t._v(\"#\")]),t._v(\" ①本质\")]),t._v(\" \"),s(\"ul\",[s(\"li\",[t._v(\"在浏览器端临时存储数据\")]),t._v(\" \"),s(\"li\",[t._v(\"键值对\")]),t._v(\" \"),s(\"li\",[t._v(\"键和值都是字符串类型\")]),t._v(\" \"),s(\"li\",[t._v(\"数据量很小\")])]),t._v(\" \"),s(\"h3\",{attrs:{id:\"_2cookie在浏览器和服务器之间的传递\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_2cookie在浏览器和服务器之间的传递\"}},[t._v(\"#\")]),t._v(\" ②Cookie在浏览器和服务器之间的传递\")]),t._v(\" \"),s(\"h4\",{attrs:{id:\"_1-没有cookie的状态\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_1-没有cookie的状态\"}},[t._v(\"#\")]),t._v(\" [1]没有Cookie的状态\")]),t._v(\" \"),s(\"p\",[t._v(\"在服务器端没有创建Cookie并返回的情况下，浏览器端不会保存Cookie信息。双方在请求和响应的过程中也不会携带Cookie的数据。\")]),t._v(\" \"),s(\"h4\",{attrs:{id:\"_2-创建cookie对象并返回\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_2-创建cookie对象并返回\"}},[t._v(\"#\")]),t._v(\" [2]创建Cookie对象并返回\")]),t._v(\" \"),s(\"div\",{staticClass:\"language-java extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-java\"}},[s(\"code\",[s(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"// 1.创建Cookie对象\")]),t._v(\"\\n\"),s(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"Cookie\")]),t._v(\" cookie \"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"new\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"Cookie\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"cookie-message\"')]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"hello-cookie\"')]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\\n\"),s(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"// 2.将Cookie对象添加到响应中\")]),t._v(\"\\nresponse\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"addCookie\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"cookie\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\\n\"),s(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"// 3.返回响应\")]),t._v(\"\\n\"),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"processTemplate\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"page-target\"')]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" request\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" response\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\")])])]),s(\"h4\",{attrs:{id:\"_3-服务器端返回cookie的响应消息头\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-服务器端返回cookie的响应消息头\"}},[t._v(\"#\")]),t._v(\" [3]服务器端返回Cookie的响应消息头\")]),t._v(\" \"),s(\"p\",[s(\"img\",{attrs:{src:\"images/img005.png\",alt:\"images\"}})]),t._v(\" \"),s(\"h4\",{attrs:{id:\"_4-浏览器拿到cookie之后\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_4-浏览器拿到cookie之后\"}},[t._v(\"#\")]),t._v(\" [4]浏览器拿到Cookie之后\")]),t._v(\" \"),s(\"p\",[t._v(\"浏览器拿到Cookie之后，以后的每一个请求都会携带Cookie信息。\")]),t._v(\" \"),s(\"p\",[s(\"img\",{attrs:{src:\"images/img006.png\",alt:\"images\"}})]),t._v(\" \"),s(\"h4\",{attrs:{id:\"_5-服务器端读取cookie的信息\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_5-服务器端读取cookie的信息\"}},[t._v(\"#\")]),t._v(\" [5]服务器端读取Cookie的信息\")]),t._v(\" \"),s(\"div\",{staticClass:\"language-java extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-java\"}},[s(\"code\",[s(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"// 1.通过request对象获取Cookie的数组\")]),t._v(\"\\n\"),s(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"Cookie\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),t._v(\" cookies \"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" request\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"getCookies\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\\n\"),s(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"// 2.遍历数组\")]),t._v(\"\\n\"),s(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"for\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"Cookie\")]),t._v(\" cookie \"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),t._v(\" cookies\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    \"),s(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"System\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"out\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"println\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"cookie.getName() = \"')]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"+\")]),t._v(\" cookie\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"getName\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),s(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"System\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"out\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"println\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"cookie.getValue() = \"')]),t._v(\" \"),s(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"+\")]),t._v(\" cookie\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"getValue\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),s(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"System\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"out\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"println\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\")])])]),s(\"h3\",{attrs:{id:\"_3cookie时效性\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3cookie时效性\"}},[t._v(\"#\")]),t._v(\" ③Cookie时效性\")]),t._v(\" \"),s(\"h4\",{attrs:{id:\"_1-理论\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_1-理论\"}},[t._v(\"#\")]),t._v(\" [1]理论\")]),t._v(\" \"),s(\"ul\",[s(\"li\",[t._v(\"会话级Cookie\\n\"),s(\"ul\",[s(\"li\",[t._v(\"服务器端并没有明确指定Cookie的存在时间\")]),t._v(\" \"),s(\"li\",[t._v(\"在浏览器端，Cookie数据存在于内存中\")]),t._v(\" \"),s(\"li\",[t._v(\"只要浏览器还开着，Cookie数据就一直都在\")]),t._v(\" \"),s(\"li\",[t._v(\"浏览器关闭，内存中的Cookie数据就会被释放\")])])]),t._v(\" \"),s(\"li\",[t._v(\"持久化Cookie\\n\"),s(\"ul\",[s(\"li\",[t._v(\"服务器端明确设置了Cookie的存在时间\")]),t._v(\" \"),s(\"li\",[t._v(\"在浏览器端，Cookie数据会被保存到硬盘上\")]),t._v(\" \"),s(\"li\",[t._v(\"Cookie在硬盘上存在的时间根据服务器端限定的时间来管控，不受浏览器关闭的影响\")]),t._v(\" \"),s(\"li\",[t._v(\"持久化Cookie到达了预设的时间会被释放\")])])])]),t._v(\" \"),s(\"p\",[t._v(\"服务器端返回Cookie时附带过期时间的响应消息头如下：\")]),t._v(\" \"),s(\"p\",[s(\"img\",{attrs:{src:\"images/img007.png\",alt:\"images\"}})]),t._v(\" \"),s(\"p\",[t._v(\"服务器通知浏览器删除Cookie时的响应消息头如下：\")]),t._v(\" \"),s(\"p\",[s(\"img\",{attrs:{src:\"images/img009.png\",alt:\"images\"}})]),t._v(\" \"),s(\"h4\",{attrs:{id:\"_2-代码\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_2-代码\"}},[t._v(\"#\")]),t._v(\" [2]代码\")]),t._v(\" \"),s(\"div\",{staticClass:\"language-java extra-class\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-java\"}},[s(\"code\",[s(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"// ※给Cookie设置过期时间\")]),t._v(\"\\n\"),s(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"// 正数：Cookie的过期时间，以秒为单位\")]),t._v(\"\\n\"),s(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"// 负数：表示这个Cookie是会话级的Cookie，浏览器关闭时释放\")]),t._v(\"\\n\"),s(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"// 0：通知浏览器立即删除这个Cookie\")]),t._v(\"\\ncookie\"),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),s(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"setMaxAge\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),s(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"20\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),s(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\")])])]),s(\"h4\",{attrs:{id:\"_3-会话和持久化cookie对比\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-会话和持久化cookie对比\"}},[t._v(\"#\")]),t._v(\" [3]会话和持久化Cookie对比\")]),t._v(\" \"),s(\"p\",[s(\"img\",{attrs:{src:\"images/img008.png\",alt:\"images\"}})]),t._v(\" \"),s(\"h3\",{attrs:{id:\"_4cookie的domain和path\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_4cookie的domain和path\"}},[t._v(\"#\")]),t._v(\" ④Cookie的domain和path\")]),t._v(\" \"),s(\"p\",[t._v(\"上网时间长了，本地会保存很多Cookie。对浏览器来说，访问互联网资源时不能每次都把所有Cookie带上。浏览器会使用Cookie的domain和path属性值来和当前访问的地址进行比较，从而决定是否携带这个Cookie。\")]),t._v(\" \"),s(\"p\",[s(\"img\",{attrs:{src:\"images/img010.png\",alt:\"images\"}})]),t._v(\" \"),s(\"p\",[s(\"RouterLink\",{attrs:{to:\"/pro001-javaweb/lecture/chapter09/verse01.html\"}},[t._v(\"上一节\")]),t._v(\" \"),s(\"RouterLink\",{attrs:{to:\"/pro001-javaweb/lecture/chapter09/index.html\"}},[t._v(\"回目录\")]),t._v(\" \"),s(\"RouterLink\",{attrs:{to:\"/pro001-javaweb/lecture/chapter09/verse03.html\"}},[t._v(\"下一节\")])],1)])}),[],!1,null,null,null);a.default=n.exports}}]);","extractedComments":[]}